<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>My Things</title>

    <!-- Bootstrap -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="bootstrap/bootstrap-4.1.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="font-awesome/fontawesome-free-5.0.13/web-fonts-with-css/css/fontawesome-all.min.css"></link>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="knockout/knockout-3.5.0/knockout-3.5.0.js"></script>
    <style>
    body {
          height: 100vh;
          padding-top: 4.5rem;
    }
    .mt-sub-a { margin-left: 15px; /* to indent sub categories */}
     div.mt-item-a {margin-left: 45px; /* to indent items */}
    .badge {float: right; /* to move the category totals to the right of the lists */}
    .mt-edit-field-button {float: right; /* move edit pencils  button to the right of field*/}
    .mt-trash, .mt-need, .mt-dialog-buttons {float: right;}
    .mt-dialog-input {width: 100%;}
    a.list-group-item { /* make category lists look like the alert */
      color: black !important;
    }
    a.list-group-item.active { /* to separate adjacent active items and override bold blue active color */
      background-color: #d6d8d9 !important;
      border-color: #c6c8c9 !important;
    }
    span.fa-pencil-alt {
      margin-right: 5px;
    }
    .fa-star {color: green;}
    html.waiting * {
      cursor: wait;
    }

    #itemDescription, #itemReview {
      height: 10vh;
    }
    #itemImage {
      width: 100%;
    }
    div.tooltip-inner {
      max-width: 350px;
    }
    .mt-textarea {
      overflow: auto;
      cursor: default;
    }
    div [readonly] {
      background-color: white !important;
    }
    </style>
  </head>
  <body>
    <div class="container-fluid" id="mainBody">
      <nav class="navbar navbar-expand-md navbar-light fixed-top bg-light nav-center" data-bind="visible: visible">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-center" id="navbarCollapse">
          <ul class="navbar-nav">
            <li class="nav-item">
              <span class="nav-link">My</span>
            </li>
            <li class="nav-item">
              <select class="custom-select"
                      id="typesSelect" data-bind="options: types,
                                                   value: type">
              </select>
            </li>
            <li class="nav-item">
              <span data-bind="visible: loggedIn">Welcome:
                <span data-bind="text: currentUser"></span>
              </span>
            </li>
            <a id="loginBtn"
               class="nav-link btn btn-sm"
               data-bind="text: (loggedIn() ? 'logout' : 'login'),
                          attr: {href: (loggedIn() ? '#/logout' : '#/login')}">
            </a>
          </ul>
        </div>
      </nav>
      <div id="alertBox" class="alert alert-dark" role="alert" data-bind="visible: visible">
        &nbsp;
      </div>
      <div class="row" data-bind="visible: visible">
        <!-- begin col-3 for hierarchical category lists-->
        <div id="itemList" class="col col-sm-4">
          <div class="btn-group btn-group-sm mt-add-buttons mb-1">
            <button
              data-bind="click: beginAddMain"
              class="btn btn-secondary mr-1">
              Add <span data-bind="text: mainLabel()">
              </span>
            </button>
            <button
              data-bind="visible: ($root.selectedMainNode() ? true : false),
                         click: beginAddSub"
              class="btn btn-secondary mr-1">
              Add <span data-bind="text: subLabel()">
              </span>
            </button>
            <button
              data-bind="visible: ($root.selectedSubNode() ? true : false),
                         click: beginAddItem"
              class="btn btn-secondary mr-1">
              Add <span data-bind="text: itemLabel()">
              </span>
            </button>
          </div>
          <!-- begin accordian main -->
          <div id="accordianMain" style="height: 75vh;overflow-y: scroll;">
            <!-- ko foreach: mainNodes -->
              <!-- begin card main -->
              <div class="card border-0" data-bind="attr:{visible: visible}">
                <span>
                  <i
                    data-bind="visible: ($root.selectedMainNode() ? ($root.selectedMainNode().id() === $data.id() ? true : false) : false),
                               attr:{title: 'Delete ' + $root.mainLabel()},
                               click: $root.beginDeleteMainNode"
                    class="fa fa-trash-alt fa-s ml-1 mr-1 mt-3 mt-trash"></i>
                    <i
                      data-bind="visible: ($root.selectedMainNode() ? ($root.selectedMainNode().id() === $data.id() ? true : false) : false),
                                 attr:{title: 'Edit ' + $root.mainLabel()},
                                 click: $root.beginEditMainNode"
                      class="fa fa-edit fa-s ml-1 mr-1 mt-3 mt-trash"></i>
                    <i
                      data-bind="visible: ($root.selectedMainNode() ? ($root.selectedMainNode().id() === $data.id() ? true : false) : false),
                                 attr:{title: 'Add ' + $root.subLabel()},
                                 click: $root.beginAddSub"
                      class="fa fa-plus fa-s ml-1 mr-1 mt-3 mt-trash"></i>
                  <a data-bind="attr: { href: '#/'+$root.type()+'/'+id(),
                                        'mt-data-id': id}"
                    class="list-group-item mt-main-a text-truncate border-0 mb-1">
                    <span>
                      <span class="badge badge-secondary"
                            data-bind="text: $root.mainLeavesNeeded($data),
                                       style:{'background-color': $root.mainLeavesNeeded($data) ? 'red' : 'green'}"
                            title="need"></span>
                      <i data-bind="attr: {class: 'fa ' + (collapsed() ? 'fa-plus' : 'fa-minus') + ' fa-xs',
                                        title: (collapsed() ? 'expand' : 'collapse')}"></i>
                      <i data-bind="style: {opacity: ($root.mainLeavesHaveTried($data) ? '1.0': '0.2'),
                                            color: ($root.mainAllLeavesHaveTried($data) ? 'green' : 'black')},
                                            attr: {class: ($root.mainAllLeavesHaveTried($data) ? 'fa fa-times fa-s' : 'fa fa-check fa-xs')},
                                    attr: {title: $root.triedLabel}"></i>
                      <span class="fa-stack fa-fw"
                            data-bind="style: {opacity: ($root.mainLeavesHaveRating($data) ? '1.0': '0.5')}"
                            title="rating">
                        <i class="far fa-star fa-stack-2x pb-1"></i>
                        <i class="fa fa-text fa-xs pl-1"
                           data-bind="text: $root.mainAverageRating($data)"></i>
                      </span>
                      <span data-toggle="tooltip"
                            data-html="true"
                            data-bind="text: name,
                                       attr: {'data-original-title': nodeTooltip}"
                            data-boundary="viewport"
                            class="mt-tooltip">
                      </span>
                  </span>
                  </a>
                </span>
              </div>
              <!-- end card main -->
              <!-- begin sub node collapsed div -->
              <div data-bind="attr: {id: 'accordianCollapse_' + id()}"
                  class="mt-main-collapse">
                <!-- begin sub accordian -->
                <div data-bind="attr: { id: 'accordian_' + id() }">
                  <!-- ko foreach: children -->
                    <!-- begin sub card -->
                    <div class="card border-0" data-bind="visible: visible">
                      <span>
                        <i
                          data-bind="visible: ($root.selectedSubNode() ? ($root.selectedSubNode().id() === $data.id() ? true : false) : false),
                                     attr:{title: 'Delete ' + $root.subLabel()},
                                     click: $root.beginDeleteSubNode"
                          class="fa fa-trash-alt fa-s ml-1 mr-1 mt-3 mt-trash"></i>
                          <i
                            data-bind="visible: ($root.selectedSubNode() ? ($root.selectedSubNode().id() === $data.id() ? true : false) : false),
                                       attr:{title: 'Edit ' + $root.subLabel()},
                                       click: $root.beginEditSubNode"
                            class="fa fa-edit fa-s ml-1 mr-1 mt-3 mt-trash"></i>
                          <i
                            data-bind="visible: ($root.selectedSubNode() ? ($root.selectedSubNode().id() === $data.id() ? true : false) : false),
                                       attr:{title: 'Add ' + $root.itemLabel()},
                                       click: $root.beginAddItem"
                            class="fa fa-plus fa-s ml-1 mr-1 mt-3 mt-trash"></i>
                        <a data-bind="attr: { href: '#/'+$root.type()+'/'+id(),
                                              'mt-data-id': id,
                                              'data-target': '#accordianCollapse_'+id()}"
                          class="list-group-item mt-sub-a text-truncate border-0 mb-1">
                          <span>
                            <span class="badge badge-secondary"
                                  data-bind="text: $root.leavesNeeded($data),
                                             style:{'background-color': $root.leavesNeeded($data) ? 'red' : 'green'}"
                                  title="need"></span>
                            <i data-bind="attr: {class: 'fa ' + (collapsed() ? 'fa-plus' : 'fa-minus') + ' fa-xs',
                                              title: (collapsed() ? 'expand' : 'collapse')}"></i>
                            <i data-bind="style: {opacity: ($root.leavesHaveTried($data) ? '1.0': '0.2'),
                                                  color: ($root.allLeavesHaveTried($data) ? 'green' : 'black')},
                                                  attr: {class: ($root.allLeavesHaveTried($data) ? 'fa fa-times fa-s' : 'fa fa-check fa-xs'),
                                                         title: $root.triedLabel}"></i>
                            <span class="fa-stack fa-fw"
                                  data-bind="style: {opacity: ($root.leavesHaveRating($data) ? '1.0': '0.5')}"
                                  title="rating">
                              <i class="far fa-star fa-stack-2x pb-1"></i>
                              <i class="fa fa-text fa-xs pl-1"
                                 data-bind="text: $root.averageRating($data)"></i>
                            </span>
                            <span data-toggle="tooltip"
                                  data-html="true"
                                  data-bind="text: name,
                                             attr: {'data-original-title': nodeTooltip}"
                                  data-boundary="viewport"
                                  class="mt-tooltip">
                            </span>
                          </span>
                        </a>
                      </span>
                      <!-- begin item card -->
                      <div class="card border-0">
                        <span>
                          <!-- begin item collapse -->
                          <div data-bind="attr: { id: 'accordianCollapse_' + id(),'data-parent': '#accordian_' + $parent.id() }"
                              class="collapse mt-sub-collapse mt-item-a">
                            <!-- ko foreach: children -->
                            <div data-bind="visible: visible">
                              <a data-bind="style: {opacity: ($root.selectedItem() && $root.selectedItem().id() === $data.id() ? '1.0': '0.2'),
                                                      color: (need() ? 'red': 'black')},
                                            attr: {href: '#/'+$root.type()+'/'+id()+'?toggleNeed'}"
                                      title="need"
                                      class="ml-1 mr-1 mt-3 mt-need fa fa-cart-plus fa-s"></a>
                              <i
                              data-bind="visible: ($root.selectedItem() ? ($root.selectedItem().id() === $data.id() ? true : false) : false),
                                         attr:{title: 'Delete ' + $root.itemLabel()},
                                         click: $root.beginDeleteItem"
                              class="fa fa-trash-alt fa-s ml-1 mr-1 mt-3 mt-trash"></i>
                              <i
                                data-bind="visible: ($root.selectedItem() ? ($root.selectedItem().id() === $data.id() ? true : false) : false),
                                           attr:{title: 'Edit ' + $root.itemLabel()},
                                           click: $root.beginEditItem"
                                class="fa fa-edit fa-s ml-1 mr-1 mt-3 mt-trash"></i>
                                <a data-bind="attr: { href: '#/'+$root.type()+'/'+id(),
                                                      'mt-data-id': id}"
                                  class="list-group-item mt-item-a text-truncate border-0 mb-1" >
                                  <span class="mt-item">
                                    <i data-bind="style: {opacity: (haveTried() ? '1.0': '0.2')}"
                                          title="tried"
                                          class="fa fa-check fa-xs"></i>
                                    <span class="fa-stack fa-fw"
                                          data-bind="style: {opacity: (rating() !== null && rating() !== '' ? '1.0': '0.5')}"
                                          title="rating">
                                      <i class="far fa-star fa-stack-2x pb-1"></i>
                                      <i class="fa fa-text fa-xs pl-1"
                                         data-bind="text: (rating() ? rating() : '')"></i>
                                    </span>
                                    <span data-bind="visible: sortIndex() !== null && sortIndex() !== ''" class="mr-1 ml-1">
                                      (<span data-bind="text: sortIndex"
                                             class="mt-tooltip"></span>)
                                    </span>
                                    <span data-bind="text: name,
                                                     attr:{title: name,
                                                           'data-original-title': name,
                                                           'mt-data-id': id }"
                                          data-boundary="viewport">
                                    </span>
                                  </span>
                                </a>
                              </div>
                            <!-- /ko -->
                          </div>
                        </span>
                        <!-- end item collapse -->
                      </div>
                      <!-- end item card -->
                    </div>
                    <!-- end sub card -->
                  <!-- /ko -->
                </div>
                <!-- end sub accordian -->
              </div>
              <!-- end sub node collapsed div -->
            <!-- /ko -->
          </div>
          <!-- end accordian main -->
        </div>
        <!-- end col-3 -->
        <!-- begin col-8 for item details/search/sort -->
        <div class="col d-none d-sm-block">
          <ul class="nav nav-tabs" id="tabs" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" id="itemDetailsTab" data-toggle="tab" href="#itemDetails" role="tab">Item Details</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="searchTab" data-toggle="tab" href="#search" role="tab" >Search</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="sortTab" data-toggle="tab" href="#sortedList" role="tab" >Sort</a>
            </li>
          </ul>
          <div class="tab-content">
            <div  id="itemDetails" class="col card tab-pane fade show active"  style="height: 85vh;overflow-y: scroll-y;">
              <div class="row">
                <div class="col-3">
                  <div
                    id="mainName"
                    data-bind="attr: {title:mainLabel()+': '+(selectedMainNode()?(selectedMainNode().name()?selectedMainNode().name():'&nbsp;'):'&nbsp;')},
                              text: (selectedMainNode()?(selectedMainNode().name()?selectedMainNode().name():'&nbsp;'):'&nbsp;')"
                    class="form-control text-center text-truncate"
                    readonly>
                  </div>
                </div>
                <div class="col-3">
                  <div
                    id="subName"
                    data-bind="attr: {'title':subLabel()+': '+(selectedSubNode()?selectedSubNode().name():'')},
                              text: (selectedSubNode()?(selectedSubNode().name()?selectedSubNode().name():'&nbsp;'):'&nbsp;')"
                    class="form-control text-center text-truncate"
                    readonly>
                  </div>
                </div>
                <div
                  id="itemSortIndex"
                  data-bind="attr: {title:sortIndexLabel()+': '+(selectedItem() ? (selectedItem().sortIndex()? selectedItem().sortIndex(): '&nbsp;') : '&nbsp;')},
                            text: (selectedItem() ? (selectedItem().sortIndex()? selectedItem().sortIndex: '#') : ''),
                            visible: $root.type() === 'books' || $root.type() === 'videos'"
                  class="col-1 form-control text-center mt-item-form mt-item-editable"
                  readonly>
                </div>
                <div data-bind="class: $root.itemNameColClass">
                  <div
                    id="itemName"
                    data-bind="attr: {title: itemLabel() +  ': '+(selectedItem() ? selectedItem().name() : '')},
                              text: (selectedItem()?(selectedItem().name()?selectedItem().name():'&nbsp;'):'&nbsp;')"
                    data-boundary="viewport"
                    class="form-control text-center text-truncate mt-item-editable"
                    readonly>
                  </div>
                </div>
                <div class="col-2 text-center mt-item-form">
                  <input id="tried"
                         data-bind="checked: (selectedItem() ? selectedItem().haveTried : false)"
                         class="checkbox mt-item-editable"
                         type="checkbox"
                         disabled></input>
                  <label for="tried" class="label" data-bind="text: triedLabel"></label>
                </div>
                <div class="col-1 mt-item-form">
                  <button
                    data-bind="click: beginEditItem,
                               attr: {title: 'Edit '+itemLabel()}"
                    class="btn-xs btn-secondary">
                    Edit
                  </button>
                </div>
              </div>
              <div class="row  mt-item-form">
                <div class="col">
                  <div class="row">
                    <label for="nodeInfo1" class="col-2 label" data-bind="text: nodeInfo1Label()+':'"></label>
                    <div id="nodeInfo1"
                           data-bind="text:(selectedItem()?(selectedItem().nodeInfo()[nodeInfo1Key()]()?selectedItem().nodeInfo()[nodeInfo1Key()]():'&nbsp;'):'&nbsp;')"
                             class="col form-control  mt-item-editable"
                             readonly></div>
                  </div>
                  <div class="row">
                    <label for="nodeInfo2" class="col-2 label" data-bind="text: nodeInfo2Label()+':'"></label>
                    <div id="nodeInfo2"
                           data-bind="text:(selectedItem()?(selectedItem().nodeInfo()[nodeInfo2Key()]()?selectedItem().nodeInfo()[nodeInfo2Key()]():'&nbsp;'):'&nbsp;')"
                           class="col form-control mt-item-editable"
                           readonly></div>
                  </div>
                  <div class="row">
                    <label for="nodeInfo3" class="col-2 label" data-bind="text: nodeInfo3Label()+':'"></label>
                    <div id="nodeInfo3"
                           data-bind="text:(selectedItem()?(selectedItem().nodeInfo()[nodeInfo3Key()]()?selectedItem().nodeInfo()[nodeInfo3Key()]():'&nbsp;'):'&nbsp;')"
                           class="col form-control mt-item-editable"
                           readonly></div>
                  </div>
                  <div class="row">
                    <label for="nodeInfo4" class="col-2 label" data-bind="text: nodeInfo4Label()+':'"></label>
                    <div id="nodeInfo4"
                           data-bind="text:(selectedItem()?(selectedItem().nodeInfo()[nodeInfo4Key()]()?selectedItem().nodeInfo()[nodeInfo4Key()]():'&nbsp;'):'&nbsp;')"
                           class="col form-control mt-item-editable"
                           readonly></div>
                  </div>
                  <div class="row">
                    <label for="nodeInfo5" class="col-2 label"
                           data-bind="text: nodeInfo5Label()+':'"></label>
                    <div id="nodeInfo5"
                           data-bind="text:(selectedItem()?(selectedItem().nodeInfo()[nodeInfo5Key()]()?selectedItem().nodeInfo()[nodeInfo5Key()]():'&nbsp;'):'&nbsp;')"
                           class="col form-control mt-item-editable"
                           readonly></div>
                  </div>
                  <div class="row">
                    <div class="col">
                      <label for="nodeInfo6" class="col-2 label" data-bind="text: nodeInfo6Label()+':'"></label>
                      <a id="nodeInfo6"
                         data-bind="text: (selectedItem()?(selectedItem().name()?selectedItem().name():'&nbsp;'):'&nbsp;'),
                                    attr: {href: (selectedItem() ? selectedItem().nodeInfo()[nodeInfo6Key()]():'')}"
                         target="_blank"
                         class="col mt-item-editable">
                      </a>
                    </div>
                  </div>
                </div>
                <div class="col-2">
                  <div
                    id="triedDate"
                    data-bind="attr: {title: 'Date '+triedLabel()},
                              text: (selectedItem()?(selectedItem().dateTried()?selectedItem().dateTried() : '&nbsp;'):'&nbsp;')"
                    data-boundary="viewport"
                    class="form-control text-center mt-item-editable"
                    readonly>
                  </div>
                  <img id="itemImage" class="img-fluid"
                       data-bind="attr:{src: (selectedItem() ? selectedItem().image : '')}"></img>
                </div>
              </div>
              <div class="row  mt-item-form">
                <div class="col">
                  <label for="itemDescription" class="label">Description:</label>
                  <div
                    id="itemDescription"
                    data-bind="text: (selectedItem()?(selectedItem().description()?selectedItem().description():'&nbsp;'):'&nbsp;'),
                               click: viewDescription"
                    type="textarea"
                    data-boundary="viewport"
                    class="form-control text-wrap mt-textarea mt-item-editable"
                    title="Click to view"
                    ></div>
                </div>
              </div>
              <div class="row  mt-item-form">
                <div class="col-1">
                  <label for="reviewedDate" class="label">Reviewed:</label>
                </div>
                <div class="col-2">
                  <div
                    id="reviewedDate"
                    data-bind="text: (selectedItem()?(selectedItem().dateReviewed()?selectedItem().dateReviewed():'&nbsp;'):'&nbsp;')"
                    data-boundary="viewport"
                    class="form-control text-center mt-item-editable"
                    readonly>
                  </div>
                </div>
                <div class="col-1 text-right">
                  <label for="rating" class="label">Rating (0-10):</label>
                </div>
                <div class="col-2">
                  <div
                    id="rating"
                    data-bind="text: (selectedItem()?(selectedItem().rating()?selectedItem().rating():'&nbsp;'):'&nbsp;')"
                    data-boundary="viewport"
                    class="form-control text-center mt-item-editable"
                    readonly>
                  </div>
                </div>
              </div>
              <div class="row  mt-item-form">
                <div class="col">
                  <label for="itemReview" class="label">Review:</label>
                  <div
                    id="itemReview"
                    data-bind="text: (selectedItem()?(selectedItem().review()?selectedItem().review():'&nbsp;'):'&nbsp;'),
                               click: viewReview"
                    type="textarea"
                    data-boundary="viewport"
                    class="form-control text-wrap mt-textarea mt-item-editable"
                    title="Click to view"></div>
                </div>
              </div>
            </div>
            <div  id="search" class="tab-pane fade">
              <div id="filterControls">
                <div class="form-check form-check-inline">
                  <label class="form-check-label" for="filterOptMainName"
                         data-bind="text: mainLabel()">
                  </label>
                  <input type="radio" class="form-check-input" name="filterOptions" value="mainNameFilter" id="filterOptMainName" checked></input>
                </div>
                <div class="form-check form-check-inline">
                  <label class="form-check-label" for="filterOptItemName"
                        data-bind="text: itemLabel()+' Name'">
                  </label>
                  <input type="radio" class="form-check-input" name="filterOptions" value="itemNameFilter" id="filterOptItemName"></input>
                </div>
                <div class="form-check form-check-inline">
                  <label class="form-check-label" for="filterOptItemDescr"
                         data-bind="text: itemLabel()+' Description'">
                  </label>
                  <input type="radio" class="form-check-input" name="filterOptions" value="itemDescrFilter" id="filterOptItemDescr"></input>
                </div>
                <div class="form-check form-check-inline">
                  <label class="form-check-label" for="filterOptReview">Review</label>
                  <input type="radio" class="form-check-input" name="filterOptions" value="reviewFilter" id="filterOptReview"></input>
                </div>
              </div>
              <div class="form-row">
                <div class="col-md-11">
                  <input
                    id="filterText"
                    data-bind="attr: {placeholder: 'enter search text'},
                              textInput: filterText"
                    type="text"
                    data-boundary="viewport"
                    class="form-control">
                  </input>
                </div>
                <div class="col">
                  <button
                    data-bind="click: filter"
                    class="form-control btn btn-secondary"
                    title="Search">
                    <i class="fas fa-search"></i>
                  </button>
                </div>
              </div>
              <div class="card" style="height: 72vh;overflow-y: scroll;">
                <!-- ko foreach: filterItems -->
                  <div>
                    <a data-bind="attr:{href: $root.nodeHref(id())},
                                  text: $root.filteredNodeSlug(id())">
                    </a>
                  </div>
                <!-- /ko -->
              </div>
            </div>
            <div  id="sortedList" class="tab-pane fade">
              <div id="sortControls">
                <div class="form-check form-check-inline">
                  <label class="form-check-label" for="sortedOptMainRating"
                        data-bind="text: mainLabel()+' Rating'">
                  </label>
                  <input type="radio" class="form-check-input" name="sortedListOptions" value="mainRatingSort" id="sortedOptMainRating"></input>
                </div>
                <div class="form-check form-check-inline">
                  <label class="form-check-label" for="sortedOptItemRating"
                        data-bind="text: itemLabel()+' Rating'">
                  </label>
                  <input type="radio" class="form-check-input" name="sortedListOptions" value="itemRatingSort" id="sortedOptItemRating"></input>
                </div>
                <div class="form-check form-check-inline">
                  <label class="form-check-label" for="sortedOptAdded"
                         data-bind="text: 'Date '+triedLabel()">
                  </label>
                  <input type="radio" class="form-check-input" name="sortedListOptions" value="addedSort" id="sortedOptAdded"></input>
                </div>
              </div>
              <div class="card" style="height: 72vh;overflow-y: scroll;">
                <!-- ko foreach: sortedItems -->
                  <div>
                    <span class="fa-stack fa-fw mt-rating-list"
                          data-bind="style: {opacity: (averageRating() !== null ? '1.0': '0.5')}"
                          title="rating">
                      <i class="far fa-star fa-stack-2x pb-1"></i>
                      <i class="fa fa-text fa-xs pl-1"
                         data-bind="text: averageRating()"></i>
                    </span>
                    <span class="mt-date-list" data-bind="text: ('0'+((new Date(dateTried())).getMonth()+1)).substr(-2,2)+'/'+('0'+(new Date(dateTried()).getDate())).substr(-2,2)+'/'+('0'+(new Date(dateTried())).getFullYear()).substr(-2,2)"> </span>
                    <a data-bind="attr:{href: $root.nodeHref(id())},
                                  text: $root.nodeSlug(id())">
                    </a>
                  </div>
                <!-- /ko -->
              </div>
            </div>
          </div>
        </div>
        <!-- end col-8 -->
      </div>
      <!-- end row -->
      <div id="confirmDeleteItem" class="modal hide fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Confirm Deletion of: <span data-bind="text:(selectedItem()?selectedItem().name():'')"></span></h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Cancel">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <p>Warning! This will permanently remove the <span data-bind="text: nodesViewModel.itemLabel()"></span> from the database. Proceed?</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" >Cancel Delete</button>
              <button type="button" class="btn btn-primary" data-dismiss="modal" data-bind="click: proceedWithItemDelete">Proceed</button>
            </div>
          </div>
        </div>
      </div>
      <div id="confirmDeleteMainNode" class="modal hide fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Confirm Deletion of: <span data-bind="text:(selectedMainNode()? selectedMainNode().name():'')"></span></h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Cancel">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <p>Warning! This will permanently remove the <span data-bind="text: mainLabel"></span> and all <span data-bind="text: subLabel"></span> and <span data-bind="text: itemLabel"></span>s from the database. Proceed?</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" >Cancel Delete</button>
              <button type="button" class="btn btn-primary" data-dismiss="modal" data-bind="click: proceedWithMainNodeDelete">Proceed</button>
            </div>
          </div>
        </div>
      </div>
      <div id="confirmDeleteSubNode" class="modal hide fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Confirm Deletion of: <span data-bind="text:(selectedSubNode()?selectedSubNode().name():'')"></span></h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Cancel">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <p>Warning! This will permanently remove the <span data-bind="text: subLabel"></span> and all <span data-bind="text: itemLabel"></span>s from the database. Proceed?</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" >Cancel Delete</button>
              <button type="button" class="btn btn-primary" data-dismiss="modal" data-bind="click: proceedWithSubNodeDelete">Proceed</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- end container-fluid -->
    <div id="editMainNode" class="modal hide fade" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit: <span data-bind="text: (nodesViewModel.selectedMainNode() ? nodesViewModel.selectedMainNode().name() : '')"></span></h5>
            <div class="mt-dialog-buttons">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" >Cancel</button>
              <button type="button" class="btn btn-primary" data-dismiss="modal" data-bind="click: editMainNode">Proceed</button>
            </div>
          </div>
          <div class="modal-body">
            <form class="form-horizontal">
              <div class="control-group">
                <label class="control-label" for="editMainNodeName">Name</label>
                <div class="controls">
                  <input class="mt-dialog-input" data-bind="textInput: name" type="inputText" id="editMainNodeName" placeholder="Name">
                  </input>
                </div>
              </div>
              <div class="control-group">
                <label class="control-label" for="editMainNodeDescription">Description</label>
                <div class="controls">
                  <textarea class="mt-dialog-input" data-bind="textInput: description" id="editMainNodeDescription" placeholder="Description">
                  </textarea>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <div id="editSubNode" class="modal hide fade" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit: <span data-bind="text: (nodesViewModel.selectedSubNode() ? nodesViewModel.selectedSubNode().name() : '')"></span></h5>
            <div class="mt-dialog-buttons">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" >Cancel</button>
              <button type="button" class="btn btn-primary" data-dismiss="modal" data-bind="click: editSubNode">Proceed</button>
            </div>
          </div>
          <div class="modal-body">
            <form class="form-horizontal">
              <div class="control-group">
                <label class="control-label" for="editSubNodeName">Name</label>
                <div class="controls">
                  <input class="mt-dialog-input" data-bind="textInput: name" type="inputText" id="editSubNodeName" placeholder="Name">
                  </input>
                </div>
              </div>
              <div class="control-group">
                <label class="control-label" for="editSubNodeDescription">Description</label>
                <div class="controls">
                  <textarea class="mt-dialog-input" data-bind="textInput: description" id="editSubNodeDescription" placeholder="Description">
                  </textarea>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <div id="editItemNode" class="modal hide" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document" style="width: 90%; max-width: 90%">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit <span data-bind="text: (itemNode()?itemNode().name():'')"></span></h5>
            <div class="mt-dialog-buttons">
              <button type="button" class="btn btn-primary" data-bind="click: editItemNodeModel.saveItem">Save&nbsp;&amp;&nbsp;Close</button>
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            </div>
          </div>
          <div class="modal-body">
            <div id="editItemNodeAlertBox" class="alert alert-dark" role="alert">
              &nbsp;
            </div>
            <div class = "mt-item-edit-form">
              <div class="row">
                <div class="col">
                  <div
                    id="mainNodeName"
                    data-bind="attr: {title: nodesViewModel.mainLabel()+': '+(mainNode() ? mainNode().name():''),
                                      placeholder: nodesViewModel.mainLabel},
                              text: (mainNode()?mainNode().name():'&nbsp;')"
                    data-boundary="viewport"
                    class="form-control text-center"
                    readonly>
                  </div>
                </div>
                <div class="col">
                  <div
                    id="subNodeName"
                    data-bind="attr: {title:nodesViewModel.subLabel()+': '+(subNode()?subNode().name():''),
                                      placeholder: nodesViewModel.subLabel},
                              text: (subNode()?subNode().name():'&nbsp;')"
                    data-boundary="viewport"
                    class="form-control text-center"
                    readonly>
                  </div>
                </div>
                <input
                  id="itemNodeSortIndex"
                  data-bind="attr: {title:nodesViewModel.sortIndexLabel()+': '+(itemNode()?(itemNode().sortIndex()?itemNode().sortIndex():'') : ''),
                                    placeholder: '#'},
                            textInput: (itemNode()?itemNode().sortIndex:'&nbsp;'),
                            visible: nodesViewModel.type() === 'books' || nodesViewModel.type() === 'videos'"
                  type="text"
                  data-boundary="viewport"
                  class="col-1 form-control text-center">
                </input>
                <div class="col">
                  <input
                    id="itemNodeName"
                    data-bind="attr: {title:nodesViewModel.itemLabel()+': '+(itemNode()?itemNode().name():''),
                                      placeholder: nodesViewModel.itemLabel()},
                              textInput: (itemNode()?itemNode().name:'&nbsp;')"
                    type="text"
                    data-boundary="viewport"
                    class="form-control text-center text">
                  </input>
                </div>
                <div class="col-2 text-center">
                  <input id="itemNodeTried"
                         data-bind="checked:(itemNode()?itemNode().haveTried:false)"
                         class="checkbox"
                         type="checkbox"></input>
                  <label for="tried" class="label" data-bind="text:nodesViewModel.triedLabel"></label>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <div class="row">
                  <label for="itemNodeInfo1" class="col-2 label" data-bind="text: nodesViewModel.nodeInfo1Label()+':'"></label>
                  <input id="itemNodeInfo1"
                         data-bind="textInput:(itemNode()?itemNode().nodeInfo()[nodesViewModel.nodeInfo1Key()]:'&nbsp;'),
                                    attr:{placeholder: nodesViewModel.nodeInfo1Label()}"
                           class="col form-control"
                           type="text"></input>
                  </div>
                  <div class="row">
                    <label for="itemNodeInfo2" class="col-2 label" data-bind="text:nodesViewModel.nodeInfo2Label()+':'"></label>
                    <input id="itemNodeInfo2"
                           data-bind="textInput:(itemNode()?itemNode().nodeInfo()[nodesViewModel.nodeInfo2Key()]:'&nbsp;'),
                                      attr:{placeholder:nodesViewModel.nodeInfo2Label()}"
                           class="col form-control"
                           type="text"></input>
                  </div>
                  <div class="row">
                    <label for="itemNodeInfo3" class="col-2 label" data-bind="text:nodesViewModel.nodeInfo3Label() + ':'"></label>
                    <input id="itemNodeInfo3"
                           data-bind="textInput:(itemNode()?itemNode().nodeInfo()[nodesViewModel.nodeInfo3Key()]:'&nbsp;'),
                                      attr:{placeholder:nodesViewModel.nodeInfo3Label()}"
                           class="col form-control"
                           type="text"></input>
                  </div>
                  <div class="row">
                    <label for="itemNodeInfo4" class="col-2 label" data-bind="text:nodesViewModel.nodeInfo4Label() + ':'"></label>
                    <input id="itemNodeInfo4"
                           data-bind="textInput:(itemNode()?itemNode().nodeInfo()[nodesViewModel.nodeInfo4Key()]:'&nbsp;'),
                                      attr:{placeholder:nodesViewModel.nodeInfo4Label()}"
                           class="col form-control"
                           type="text"></input>
                    <button class="btn btn-secondary btn-sm col-1"
                       data-bind="click: fillItemFromGoogle,
                                  visible: nodesViewModel.type() === 'books',
                                  attr: {title: 'Attempt to fill information from books.google.com'}">
                       <span data-bind="html:nodesViewModel.fillItemFromGoogleIcon"></span>
                    </button>
                  </div>
                  <div class="row">
                    <label for="itemNodeInfo5" class="col-2 label"
                           data-bind="text:nodesViewModel.nodeInfo5Label() + ':'"></label>
                    <input id="itemNodeInfo5"
                           data-bind="textInput:(itemNode()?itemNode().nodeInfo()[nodesViewModel.nodeInfo5Key()]:'&nbsp;'),
                                      attr:{placeholder:nodesViewModel.nodeInfo5Label()}"
                           class="col form-control"
                           type="text"></input>
                  </div>
                  <div class="row">
                    <label for="itemNodeInfo6" class="col-2 label" data-bind="text:nodesViewModel.nodeInfo6Label() + ':'"></label>
                    <input id="itemNodeInfo6"
                           data-bind="textInput:(itemNode()?itemNode().nodeInfo()[nodesViewModel.nodeInfo6Key()]:'&nbsp;'),
                                      attr:{placeholder:nodesViewModel.nodeInfo6Label()}"
                           class="col form-control"
                           type="url"></input>
                  </div>
                </div>
                <div class="col-2">
                  <input
                    id="itemNodeTriedDate"
                    data-bind="attr: {title: 'Date '+nodesViewModel.triedLabel(),
                                      placeholder: 'Date '+nodesViewModel.triedLabel()},
                              textInput: (itemNode()?itemNode().dateTried:'&nbsp;')"
                    type="text"
                    data-boundary="viewport"
                    class="form-control text-center">
                  </input>
                  <div>
                    <img id="itemNodeImage" class="img-fluid"
                         data-bind="attr:{src:(itemNode()?itemNode().image :'')}"></img>
                    <button class="btn btn-secondary btn-sm mt-edit-field-button"
                            title="Edit image"
                            data-boundary="viewport"
                            data-bind="click:nodesViewModel.editItemImage,
                                       visible: false">
                            <span class="fa fa-edit fa-xs"></span>
                    </button>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <label for="itemNodeDescription" class="label">Description:</label>
                  <textarea
                    id="itemNodeDescription"
                    data-bind="textInput:(itemNode()?itemNode().description:'')"
                    type="textarea"
                    data-boundary="viewport"
                    class="form-control text-wrap"
                    placeholder="Description">
                  </textarea>
                </div>
              </div>
              <div class="row">
                <div class="col-1">
                  <label for="itemNodeReviewedDate" class="label">Reviewed:</label>
                </div>
                <div class="col-2">
                  <input
                    id="itemNodeReviewedDate"
                    data-bind="textInput:(itemNode()?itemNode().dateReviewed:'&nbsp;')"
                    type="text"
                    data-boundary="viewport"
                    title="Review Date"
                    class="form-control text-center"
                    placeholder="Review Date">
                  </input>
                </div>
                <div class="col-1 text-right">
                  <label for="itemNodeRating" class="label">Rating (0-10):</label>
                </div>
                <div class="col-2">
                  <input
                    id="itemNodeRating"
                    data-bind="textInput:(itemNode()?itemNode().rating:'&nbsp;')"
                    type="text"
                    data-boundary="viewport"
                    title="Rating"
                    class="form-control text-center"
                    placeholder="Rating">
                  </input>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <textarea
                    id="itemNodeReview"
                    data-bind="textInput:(itemNode()?itemNode().review:'')"
                    type="textarea"
                    data-boundary="viewport"
                    class="form-control text-wrap"
                    placeholder="Review">
                  </textarea>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="addMainNode" class="modal hide fade" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add <span data-bind="text: nodesViewModel.mainLabel"></span></h5>
            <div class="mt-dialog-buttons">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" >Cancel</button>
              <button type="button" class="btn btn-primary" data-dismiss="modal" data-bind="click: addMainNode">Proceed</button>
            </div>
          </div>
          <div class="modal-body">
            <form class="form-horizontal">
              <div class="control-group">
                <label class="control-label" for="inputMainNodeName">Name</label>
                <div class="controls">
                  <input class="mt-dialog-input" data-bind="textInput: name" type="inputText" id="inputMainNodeName" placeholder="Name">
                  </input>
                </div>
              </div>
              <div class="control-group">
                <label class="control-label" for="inputMainNodeDescription">Description</label>
                <div class="controls">
                  <textarea class="mt-dialog-input" data-bind="textInput: description" id="inputMainNodeDescription" placeholder="Description">
                  </textarea>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <div id="addSubNode" class="modal hide fade" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add  <span data-bind="text: nodesViewModel.subLabel"></span></h5>
            <div class="mt-dialog-buttons">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" >Cancel</button>
              <button type="button" class="btn btn-primary" data-dismiss="modal" data-bind="click: addSubNode">Proceed</button>
            </div>
          </div>
          <div class="modal-body">
            <form class="form-horizontal">
              <div class="control-group">
                <label class="control-label" for="inputSubNodeName">Name</label>
                <div class="controls">
                  <input class="mt-dialog-input" data-bind="textInput: name" type="inputText" id="inputSubNodeName" placeholder="Name">
                  </input>
                </div>
              </div>
              <div class="control-group">
                <label class="control-label" for="inputSubNodeDescription">Description</label>
                <div class="controls">
                  <textarea class="mt-dialog-input" data-bind="textInput: description" id="inputSubNodeDescription" placeholder="Description">
                  </textarea>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <div id="login" class="modal hide fade" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Login</h5>
            <div class="mt-dialog-buttons">
              <button type="button" class="btn btn-secondary" data-bind="click: nodesViewModel.cancelLogin" data-dismiss="modal" >Cancel</button>
              <button type="button" class="btn btn-primary" data-dismiss="modal" data-bind="click: login">Proceed</button>
            </div>
          </div>
          <div class="modal-body">
            <form class="form-horizontal">
              <div class="control-group">
                <label class="control-label" for="inputUsename">Username</label>
                <div class="controls">
                  <input class="mt-dialog-input" data-bind="textInput: username" type="inputText" id="inputUsername" placeholder="Username" autofocus>
                  </input>
                </div>
              </div>
              <div class="control-group">
                <label class="control-label" for="inputPassword">Description</label>
                <div class="controls">
                  <input class="mt-dialog-input" data-bind="textInput: password" type="password" id="inputPassword" placeholder="Password">
                </input>
                </div>
              </div>
              <div class="control-group">
                <label class="control-label" for="inputType">Type</label>
                <div class="controls">
                          <select class="custom-select"
                                  id="inputType" data-bind="options: types,
                                                               value: type">
                          </select>
                </input>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <div id="loadingDialog" class="modal hide" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Loading: <span data-bind="text: nodesViewModel.type()"></span></h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Cancel"
               data-bind="click: nodesViewModel.logout">
                <span aria-hidden="true">&times;</span>
              </button>
          </div>
          <div class="modal-body">
            <div class="progress">
              <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="viewText" class="modal hide fade" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document"
       style="width: 80%; max-width: 80%">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" data-bind="text: header()+': '+name()"></h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Cancel"
             data-bind="click: cancel">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p data-bind="text: text" id="viewTextContent"></p>
          </div>
        </div>
      </div>
    </div>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="jquery/jquery-3.3.1.min.js"></script>
    <script src="sammy/lib/sammy.js"></script>
    <script src="my_things/my_things_client.js"></script>
    <script src="popper/popper.js-1.14.3/dist/umd/popper.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <!-- Latest compiled and minified JavaScript -->
    <script src="bootstrap/bootstrap-4.1.2/js/bootstrap.min.js"></script>
  </body>
</html>
